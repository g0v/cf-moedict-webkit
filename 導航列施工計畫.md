# 導航列施工計畫 TODO List

## 概述

本計畫將實現與原專案 `moedict-webkit` 完全相同的導航列功能，包括桌面版和手機版的響應式設計。

## ✅ 已完成項目

- [x] **基礎導航列結構** - 實現基本的 HTML 結構和 CSS 樣式
- [x] **about.html 頁面** - 創建關於頁面
- [x] **修正導航列壓版問題** - 添加 body padding-top 和適當的 z-index

## 🔄 進行中項目

無

## 📋 待完成項目

### 桌面版導航列元素

- [x] **萌典 Logo**
  - [x] 實現點擊回到首頁功能 (`./`)
  - [x] 應用正確的 CSS 類名 (`navbar-brand`, `brand`, `ebas`)
  - [x] 參考原專案檔案: `index.html` 第31行

- [x] **辭典下拉選單**
  - [x] 實現語言切換和特殊頁面導航
  - [x] 添加書本圖示 (`icon-book`) 和下拉箭頭 (`caret`)
  - [ ] 實現下拉選單項目（巢狀結構，複刻 `scripts/Nav.jsx`）：
    - [ ] 華語 (a)
      - [ ] `##` 華語辭典（語言切換用，僅更新 lang，不換頁）
      - [ ] `…分類索引`（`li.dropdown-submenu > a.a.taxonomy`，不換頁、展開子選單）
      - [x] `…部首表`（`#@`，點擊轉向 `/@`）
    - [ ] 台語 (t)
      - [ ] `#!` 臺灣台語（語言切換用）
      - [ ] `…分類索引`（`li.dropdown-submenu > a.t.taxonomy`，不換頁、展開子選單）
      - [ ] `…諺語`（`#!=諺語`）
    - [ ] 客語 (h)
      - [ ] `#:` 臺灣客語（語言切換用）
      - [ ] `…諺語`（`#:=諺語`）
    - [ ] 兩岸 (c)
      - [ ] `#~` 兩岸詞典（語言切換用）
      - [ ] `…分類索引`（`li.dropdown-submenu > a.c.taxonomy`，不換頁、展開子選單）
      - [x] `…部首表`（`#~@`，點擊轉向 `/~@`）
  - [ ] 行為與樣式（參照原站）
    - [ ] 手機：點擊 `li.dropdown-submenu > a` 切換下一層選單（下拉）
    - [ ] 桌面：Bootstrap dropdown 樣式；`dropdown-submenu` 向右展開（沿用原 CSS）
    - [ ] 互動定義：
      - [ ] 華/台/客/兩岸條目：只切換語言（更新 `LANG`/`className`），不導頁
      - [ ] `…分類索引`：只展開子選單，不導頁
      - [ ] `…部首表`：導向 `/@` 或 `/~@`
  - [ ] 子選單資料來源（複刻原專案，不新增 API）
    - [ ] 來源：`a/=.json`, `t/=.json`, `h/=.json`, `c/=.json`（R2 `DICTIONARY` bucket）
    - [ ] 載入時機：SSR 預留容器；CSR 以既有 `deps.js`/jQuery 讀取並插入（對齊原站）
    - [ ] 結構處理：
      - [ ] 陣列：逐項渲染 `<li><a class="lang-option {lang}">項目</a></li>`
      - [ ] 物件（巢狀）：遞迴渲染多層 `dropdown-submenu`
    - [ ] 多語共存：一次渲染四語塊，與 `DropDown` 輸出一致
  - [ ] 參考原專案檔案: `index.html` 第33-46行, `scripts/Nav.jsx` 第9-18, 79-93, 96-110 行

- [ ] **字詞紀錄簿按鈕**
  - [x] 實現字詞紀錄簿按鈕 (`icon-bookmark-empty`)
  - [x] 實現點擊連到字詞紀錄簿頁面 (`#=*`)
  - [x] 實現字詞紀錄簿頁面功能：
    - [ ] 顯示用戶收藏的字詞（按詞條右方的 ⭐ 按鈕加入）
    - [x] 顯示「最近查閱過的字詞」（使用 localStorage 儲存）
    - [ ] 提供清除瀏覽紀錄功能
    - [x] 實現 localStorage 資料管理 (`lru-${LANG}` 鍵值)
  - [ ] 參考原專案檔案: `index.html` 第48行, `view.ls` 第569-601行, `main.ls` 第334-356行

- [ ] **偏好設定按鈕**
  - [ ] 實現設定按鈕 (`icon-cogs`)
  - [ ] 實現偏好設定下拉選單
  - [ ] 實現羅馬拼音顯示方式選擇：
    - [ ] 華語: 漢語拼音、華通拼音、威妥瑪式、注音二式
    - [ ] 台語: 臺羅拼音、臺通拼音、白話字
    - [ ] 客語: 客家語拼音方案、客語白話字
  - [ ] 實現條目音標顯示方式: 注音符號、羅馬拼音、關閉
  - [ ] 參考原專案檔案: `index.html` 第49行, `scripts/UserPref.jsx`

- [ ] **字體大小調整按鈕（僅 App 版）**
  - [ ] 實現字體大小調整功能
  - [ ] 應用 `resize-btn app-only` 樣式
  - [ ] 參考原專案檔案: `index.html` 第50-51行

- [ ] **Google 站內搜尋**
  - [ ] 整合 Google 自訂搜尋引擎
  - [ ] 實現搜尋引擎 ID: `007966820757635393756:sasf0rnevk4`
  - [ ] 實現依語言調整搜尋範圍：
    - [ ] 華語: 排除台語、客語、兩岸相關結果
    - [ ] 台語: 優先顯示台語相關結果
    - [ ] 客語: 優先顯示客語相關結果
    - [ ] 兩岸: 優先顯示兩岸相關結果
  - [ ] 參考原專案檔案: `index.html` 第62-66行, `main.ls` 第206-219行

- [x] **下載連結（右上對齊）**
  - [x] 桌面版下載: `https://racklin.github.io/moedict-desktop/download.html`
  - [x] Android App: `https://play.google.com/store/apps/details?id=org.audreyt.dict.moe`
  - [x] iOS App: `http://itunes.apple.com/app/id1434947403`
  - [x] 參考原專案檔案: `index.html` 第56-60行

### 手機版導航列元素

- [ ] **語言切換下拉選單**
  - [ ] 實現簡化版語言切換
  - [ ] 參考 `UI/navbar_mobile.png`

- [ ] **偏好設定下拉選單**
  - [ ] 實現簡化版設定選項
  - [ ] 參考 `UI/navbar_mobile.png`

- [ ] **搜尋框**
  - [ ] 實現 Google 站內搜尋
  - [ ] 參考 `UI/navbar_mobile.png`

### 技術實現要點

- [x] **響應式設計**
  - [x] 使用 Bootstrap 的 `hidden-xs` 類別
  - [x] 實現手機版簡化版導航列
  - [x] 參考原專案檔案: `sass/_widget.scss` 第37-49行

- [ ] **語言切換邏輯**
  - [ ] 使用 `LANG` 變數控制當前語言
  - [ ] 更新 `lang-active` 類別的內容
  - [ ] 影響字典資料讀取路徑
  - [ ] 參考原專案檔案: `main.ls` 第388-450行

- [ ] **localStorage 功能**
  - [ ] 字詞收藏: `starred-${LANG}` 鍵值
  - [ ] 瀏覽歷史: `lru-${LANG}` 鍵值
  - [ ] 偏好設定: 各種 `pinyin_*` 和 `phonetics` 鍵值
  - [ ] 參考原專案檔案: `main.ls` 第609-620行

- [ ] **Google 搜尋整合**
  - [ ] 動態載入 Google CSE JavaScript
  - [ ] 根據當前語言調整搜尋範圍
  - [ ] 參考原專案檔案: `main.ls` 第206-219行

## 📁 相關檔案清單

### 原專案參考檔案
- `moedict-webkit/index.html` - 主要 HTML 結構
- `moedict-webkit/scripts/Nav.jsx` - React 導航組件
- `moedict-webkit/scripts/UserPref.jsx` - 偏好設定組件
- `moedict-webkit/view.ls` - 字詞紀錄簿邏輯
- `moedict-webkit/main.ls` - 主要 JavaScript 邏輯
- `moedict-webkit/about.html` - 關於頁面
- `moedict-webkit/sass/_widget.scss` - 搜尋框樣式

### 新專案需要創建的檔案
- `cf-moedict-webkit/src/user-pref-component.tsx` - 偏好設定組件

---

**計畫版本**: v2.0 (TODO List 格式)
**創建日期**: 2025-10-13
**最後更新**: 2025-10-28
