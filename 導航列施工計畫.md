# 導航列施工計畫

## 概述

本計畫將實現與原專案 `moedict-webkit` 完全相同的導航列功能，包括桌面版和手機版的響應式設計。

## 桌面版導航列元素（從左到右）

### 1. 萌典 Logo
- **位置**: 最左上角
- **功能**: 點擊回到首頁 (`./`)
- **樣式**: `navbar-brand brand ebas`
- **原專案檔案**: `index.html` 第31行
- **CSS類名**: `navbar-brand`, `brand`, `ebas`

### 2. 辭典下拉選單
- **位置**: Logo 右側
- **功能**: 語言切換和特殊頁面導航
- **觸發元素**: 書本圖示 + 當前語言文字 + 下拉箭頭
- **樣式**: `dropdown-toggle` 包含 `icon-book` 和 `caret`
- **原專案檔案**: `index.html` 第33-46行, `scripts/Nav.jsx` 第9-18行

#### 下拉選單項目：
- **華語辭典** (`##`) - 預設選項
- **…分類索引** (`#=`) - 分類索引頁面
- **…部首表** (`#@`) - 部首表頁面
- **臺灣台語** (`#!`) - 台語辭典
- **…分類索引** (`#!=`) - 台語分類索引
- **…諺語** (`#!=諺語`) - 台語諺語
- **臺灣客語** (`#:`) - 客語辭典
- **…諺語** (`#:=諺語`) - 客語諺語
- **兩岸詞典** (`#~`) - 兩岸詞典
- **…分類索引** (`#~=`) - 兩岸分類索引
- **…部首表** (`#~@`) - 兩岸部首表

### 3. 字詞紀錄簿按鈕
- **位置**: 辭典選單右側
- **功能**: 連到字詞紀錄簿頁面
- **路由**: `#=*`
- **圖示**: `icon-bookmark-empty`
- **原專案檔案**: `index.html` 第48行, `view.ls` 第569-601行

#### 字詞紀錄簿功能：
- 顯示用戶收藏的字詞（按詞條右方的 ⭐ 按鈕加入）
- 顯示「最近查閱過的字詞」（使用 localStorage 儲存）
- 提供清除瀏覽紀錄功能
- 原專案檔案: `main.ls` 第334-356行, `view.ls` 第592-600行

### 4. 偏好設定按鈕
- **位置**: 字詞紀錄簿右側
- **功能**: 展開偏好設定下拉選單
- **圖示**: `icon-cogs`
- **原專案檔案**: `index.html` 第49行, `scripts/UserPref.jsx`

#### 偏好設定項目：
- **羅馬拼音顯示方式**（依語言不同）:
  - 華語: 漢語拼音、華通拼音、威妥瑪式、注音二式
  - 台語: 臺羅拼音、臺通拼音、白話字
  - 客語: 客家語拼音方案、客語白話字
- **條目音標顯示方式**: 注音符號、羅馬拼音、關閉
- **原專案檔案**: `scripts/UserPref.jsx` 第20-45行

### 5. 字體大小調整按鈕（僅 App 版）
- **位置**: 偏好設定右側（絕對定位）
- **功能**: 調整字體大小
- **樣式**: `resize-btn app-only`
- **原專案檔案**: `index.html` 第50-51行

### 6. Google 站內搜尋
- **位置**: 右上對齊
- **功能**: Google 自訂搜尋引擎
- **樣式**: `#gcse`
- **原專案檔案**: `index.html` 第62-66行, `main.ls` 第206-219行

#### 搜尋設定：
- **搜尋引擎 ID**: `007966820757635393756:sasf0rnevk4`
- **依語言調整搜尋範圍**:
  - 華語: 排除台語、客語、兩岸相關結果
  - 台語: 優先顯示台語相關結果
  - 客語: 優先顯示客語相關結果
  - 兩岸: 優先顯示兩岸相關結果

### 7. 下載連結（右上對齊）
- **桌面版下載**: `https://racklin.github.io/moedict-desktop/download.html`
- **Android App**: `https://play.google.com/store/apps/details?id=org.audreyt.dict.moe`
- **iOS App**: `http://itunes.apple.com/app/id1434947403`
- **樣式**: `web-inline-only`
- **原專案檔案**: `index.html` 第56-60行

### 8. 關於本站按鈕
- **位置**: 最右上角
- **功能**: 連到 about.html
- **樣式**: `iconic-circle` 包含 `icon-info`
- **原專案檔案**: `index.html` 第54行

## 手機版導航列元素

### 1. 語言切換下拉選單
- **位置**: 左上角
- **功能**: 簡化版語言切換
- **原專案檔案**: `UI/navbar_mobile.png` 參考

### 2. 偏好設定下拉選單
- **位置**: 語言選單右側
- **功能**: 簡化版設定選項
- **原專案檔案**: `UI/navbar_mobile.png` 參考

### 3. 搜尋框
- **位置**: 右上對齊
- **功能**: Google 站內搜尋
- **原專案檔案**: `UI/navbar_mobile.png` 參考

### 4. 字詞紀錄簿按鈕
- **位置**: 正右上角
- **功能**: 連到 `#=*` 字詞記錄簿
- **原專案檔案**: `UI/navbar_mobile.png` 參考

## 需要創建的新頁面

### 1. about.html
- **功能**: 關於本站頁面
- **內容**: 專案介紹、授權資訊、技術說明
- **原專案檔案**: `moedict-webkit/about.html`
- **重要內容**:
  - 專案簡介和功能說明
  - 資料來源和授權資訊
  - 技術棧和第三方元件
  - 開發團隊感謝
  - CC0 公眾領域貢獻宣告

### 2. 字詞紀錄簿頁面 (`#=*`)
- **功能**: 顯示收藏字詞和瀏覽歷史
- **路由處理**: 需要在前端路由中處理 `#=*`
- **資料來源**: localStorage
- **原專案檔案**: `view.ls` 第569-601行, `main.ls` 第334-356行

## 技術實現要點

### 1. 響應式設計
- 使用 Bootstrap 的 `hidden-xs` 和 `web-inline-only` 類別
- 手機版使用簡化版導航列
- 原專案檔案: `sass/_widget.scss` 第37-49行

### 2. 語言切換邏輯
- 使用 `LANG` 變數控制當前語言
- 更新 `lang-active` 類別的內容
- 影響字典資料讀取路徑
- 原專案檔案: `main.ls` 第388-450行

### 3. localStorage 功能
- 字詞收藏: `starred-${LANG}` 鍵值
- 瀏覽歷史: `lru-${LANG}` 鍵值
- 偏好設定: 各種 `pinyin_*` 和 `phonetics` 鍵值
- 原專案檔案: `main.ls` 第609-620行

### 4. Google 搜尋整合
- 動態載入 Google CSE JavaScript
- 根據當前語言調整搜尋範圍
- 原專案檔案: `main.ls` 第206-219行

## 開發優先順序

1. **基礎導航列結構** - 實現基本的 HTML 結構和 CSS 樣式
2. **語言切換功能** - 實現下拉選單和語言切換邏輯
3. **字詞紀錄簿** - 實現收藏和瀏覽歷史功能
4. **偏好設定** - 實現設定面板和 localStorage 整合
5. **Google 搜尋** - 整合 Google CSE
6. **響應式設計** - 實現手機版適配
7. **about.html 頁面** - 創建關於頁面

## 相關檔案清單

### 原專案參考檔案
- `moedict-webkit/index.html` - 主要 HTML 結構
- `moedict-webkit/scripts/Nav.jsx` - React 導航組件
- `moedict-webkit/scripts/UserPref.jsx` - 偏好設定組件
- `moedict-webkit/view.ls` - 字詞紀錄簿邏輯
- `moedict-webkit/main.ls` - 主要 JavaScript 邏輯
- `moedict-webkit/about.html` - 關於頁面
- `moedict-webkit/sass/_widget.scss` - 搜尋框樣式

### 新專案需要創建的檔案
- `cf-moedict-webkit/src/navbar-component.tsx` - 導航列 Preact 組件
- `cf-moedict-webkit/src/user-pref-component.tsx` - 偏好設定組件
- `cf-moedict-webkit/src/about-page.tsx` - 關於頁面組件
- `cf-moedict-webkit/src/starred-page.tsx` - 字詞紀錄簿頁面組件

---

**計畫版本**: v1.0
**創建日期**: 2025-01-27
**最後更新**: 2025-01-27
